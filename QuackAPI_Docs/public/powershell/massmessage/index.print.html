<!DOCTYPE html>
<html lang="en-gb" dir="ltr">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.127.0">
    <meta name="generator" content="Relearn 5.23.2+tip">
    <meta name="description" content="Documentation for the QuackBot API &amp; Machys useful scripts">
    <meta name="author" content="MACHY Of MACH 2 Simulations">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Mass Message :: Quack Bot API Docs">
    <meta name="twitter:description" content="This script will look through AD and send a message to all Computers that match a wildcard name, IE entering admin will match with admin-55, site1-admin, site1-amdin-11 etc.
OR it will go through an OU Given by Search Base
It will then display the message for the set time (MS) set to 600 by default.
Notes Example output of the message shown.
The Script itself MassMessage.ps1
$ComputerName = read-host &#34;Enter Computer name Do not include * For wild cards.">
    <meta property="og:title" content="Mass Message :: Quack Bot API Docs">
    <meta property="og:description" content="This script will look through AD and send a message to all Computers that match a wildcard name, IE entering admin will match with admin-55, site1-admin, site1-amdin-11 etc.
OR it will go through an OU Given by Search Base
It will then display the message for the set time (MS) set to 600 by default.
Notes Example output of the message shown.
The Script itself MassMessage.ps1
$ComputerName = read-host &#34;Enter Computer name Do not include * For wild cards.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://localhost:1313/powershell/massmessage/index.html">
    <meta property="article:section" content="PowerShell :: Quack Bot API Docs">
    <meta property="article:published_time" content="2024-02-08T20:04:15+00:00">
    <meta property="article:modified_time" content="2024-02-08T20:04:15+00:00">
    <meta property="og:site_name" content="Quack Bot API Docs">
    <title>Mass Message :: Quack Bot API Docs</title>
    <link href="http://localhost:1313/powershell/massmessage/index.html" rel="canonical" type="text/html" title="Mass Message :: Quack Bot API Docs">
    <link href="/powershell/massmessage/index.xml" rel="alternate" type="application/rss+xml" title="Mass Message :: Quack Bot API Docs">
    <link href="/images/favicon.png?1746567088" rel="icon" type="image/png">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1746567089" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1746567089" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1746567089" rel="stylesheet">
    <link href="/css/auto-complete.css?1746567089" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1746567089" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1746567089" rel="stylesheet">
    <link href="/css/fonts.css?1746567089" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1746567089" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1746567089" rel="stylesheet">
    <link href="/css/theme-ZenRed.css?1746567089" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-dark.css?1746567089" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/variant.css?1746567089" rel="stylesheet">
    <link href="/css/print.css?1746567089" rel="stylesheet" media="print">
    <link href="/css/format-print.css?1746567089" rel="stylesheet">
    <link href="/css/ie.css?1746567089" rel="stylesheet">
    <script src="/js/url.js?1746567089"></script>
    <script src="/js/variant.js?1746567089"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="/index.search.js";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      window.relearn = window.relearn || {};
      window.relearn.baseUriFull='http:\/\/localhost:1313/';
      // variant stuff
      window.relearn.themeVariantModifier='';
      window.variants && variants.init( [ 'ZenRed', 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'zen-auto', 'zen-light', 'zen-dark', 'neon', 'learn', 'blue', 'green', 'red', 'ZenRed' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/powershell/massmessage/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/powershell/index.html"><span itemprop="name">PowerShell</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Mass Message</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>
<h1 id="mass-message">Mass Message</h1>

<p>This script will look through AD and send a message to all Computers that match a wildcard name, IE entering admin will match with admin-55, site1-admin, site1-amdin-11 etc.<br>
OR it will go through an OU Given by <a href="/powershell/index.html#SearchBase">Search Base</a></p>
<p>It will then display the message for the set time (MS) set to 600 by default.</p>
<h2 id="notes">Notes</h2>
<p>Example output of the message shown.<br>
<a href="#R-image-6390db9f9d3cf5cea8a5b462760efa55" class="lightbox-link"><img src="/powershell/massmessage/../../PowerShell/tools_images/message.PNG" alt="image" class="figure-image border lightbox noshadow" style="height: auto; width: auto;" loading="lazy"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6390db9f9d3cf5cea8a5b462760efa55"><img src="/powershell/massmessage/../../PowerShell/tools_images/message.PNG" alt="image" class="lightbox-image border lightbox noshadow" loading="lazy"></a></p>
<h2 id="the-script-itself">The Script itself</h2>
<p><a href="/powershell/massmessage/../../PowerShell/MassMessage.ps1">MassMessage.ps1</a></p>
<div class="wrap-code highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$ComputerName = read-host <span style="color:#e6db74">&#34;Enter Computer name Do not include * For wild cards. it is added Automatically&#34;</span>
</span></span><span style="display:flex;"><span>$Computers = Get-ADComputer -Filter <span style="color:#e6db74">&#34;Name -like &#39;*</span>$ComputerName<span style="color:#e6db74">*&#39;&#34;</span> | select-object -ExpandProperty name <span style="color:#75715e">##Gets all all Computers with a host name entered above</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##Comment out the two lines above and uncomment the one bellow if you prefer to do it based on OU </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#$Computers = Get-ADComputer -SearchBase &#34;OU=YOUROUHERE,DC=DOMAIN,DC=TLD&#34; -Filter * | select-object -ExpandProperty name</span>
</span></span><span style="display:flex;"><span>$msg = read-host <span style="color:#e6db74">&#34;Please enter your message&#34;</span> <span style="color:#75715e">#Enter The Message you want it to be </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ForEach</span> ($Computer <span style="color:#66d9ef">in</span> $Computers) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (test-Connection $Computer -Count <span style="color:#ae81ff">1</span> -Quiet ) { 
</span></span><span style="display:flex;"><span>    Write-Host <span style="color:#e6db74">&#34;Sending </span>$msg<span style="color:#e6db74"> to </span>$Computer<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    Invoke-WmiMethod `
</span></span><span style="display:flex;"><span>        -Path Win32_Process `
</span></span><span style="display:flex;"><span>        -Name Create `
</span></span><span style="display:flex;"><span>        -ArgumentList <span style="color:#e6db74">&#34;msg * /time:600 </span>$msg<span style="color:#e6db74">&#34;</span> `
</span></span><span style="display:flex;"><span>        -ComputerName $Computer
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    </div>
    <script src="/js/clipboard.min.js?1746567089" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1746567089" defer></script>
    <script src="/js/theme.js?1746567089" defer></script>
  </body>
</html>
